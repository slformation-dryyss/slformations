// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               String           @id @default(cuid())
  auth0Id          String           @unique
  email            String           @unique
  name             String?

  // Profil détaillé (complété après inscription)
  firstName        String?
  lastName         String?
  phone            String?
  birthDate        DateTime?

  addressLine1     String?
  addressLine2     String?
  postalCode       String?
  city             String?
  country          String?
  
  // Profil Formateur / Enrichi
  bio              String?
  diplomas         String[]         @default([])
  badges           String[]         @default([])

  // Informations métier / formation
  profession       String?          // Métier actuel
  employerName     String?          // Nom de l'entreprise
  wantsVtcTraining Boolean?         // Candidat formation VTC
  wantsTaxiTraining Boolean?        // Candidat formation Taxi

  // Pièces administratives (références, pas les fichiers eux‑mêmes)
  nationalIdNumber String?          // N° de CNI / passeport
  drivingLicenseNumber String?      // N° de permis
  drivingLicenseType  String?       // A, B, C, etc.
  drivingLicenseIssuedAt DateTime?  // Date de délivrance du permis

  // Tracking Auth0
  lastLoginAt      DateTime?        // Dernière connexion via Auth0

  // Paiement / facturation
  stripeCustomerId String?          @unique

  // Onboarding / profil
  isProfileComplete Boolean         @default(false)
  onboardingStatus String           @default("NEW") // NEW, PENDING_DOCS, DOCS_VERIFIED, READY_TO_PAY, ACTIVE

  role             String           @default("STUDENT")
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  
  // Relations LMS & E-commerce
  enrollments      Enrollment[]
  progress         LessonProgress[]
  orders           Order[]
  
  // Relations anciennes (legacy / présentiel)
  bookings         Booking[]
  sessionBookings  SessionBooking[]
  courseSessionBookings CourseSessionBooking[]
  teachingSlots    SessionSlot[]
  sessionsTeaching Session[]        @relation("TeacherSessions")
  mainSessions     CourseSession[]  @relation("MainTeacher")

  // Relations annexes
  documents        UserDocument[]
  addresses        Address[]
  paymentLinks     PaymentLink[]
  
  // Confidentialité / RGPD
  gdprConsent      Boolean?
  gdprConsentDate  DateTime?
  marketingConsent Boolean?
  consentLogs      ConsentLog[]
  dataExportRequests DataExportRequest[]
  quizAttempts     QuizAttempt[]
  
  // Relations Système de Réservation Cours de Conduite
  instructorProfile    InstructorProfile?
  studentAssignments   InstructorAssignment[] @relation("StudentAssignments")
  studentLessons       DrivingLesson[]        @relation("StudentLessons")
  studentChangeRequests ChangeRequest[]       @relation("StudentChangeRequests")
}

model Course {
  id          String       @id @default(cuid())
  title       String
  slug        String?      @unique
  description String
  price       Float        @default(0)
  imageUrl    String?
  isPublished Boolean      @default(false)
  type        String       @default("VTC")
  maxStudents Int?         @default(0) // 0 or null = unlimited
  
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  // Relations LMS
  modules     Module[]
  enrollments Enrollment[]
  orders      Order[] // Un order peut être lié à un course spécifique (ou plusieurs via relation n-n si panier)
  categories  CourseOnCategory[]
  orderItems  OrderItem[]
  paymentLinks PaymentLink[]
  quizzes      Quiz[]
  
  // Relations anciennes
  bookings    Booking[]
  sessions    Session[]
  courseSessions CourseSession[]

  @@index([type])
  @@index([isPublished, type])
}

// Catégories de cours (pour organiser le catalogue)
model CourseCategory {
  id          String             @id @default(cuid())
  slug        String             @unique
  name        String
  description String?
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt

  courses     CourseOnCategory[]
}

// Table de liaison N-N entre Course et CourseCategory
model CourseOnCategory {
  courseId   String
  categoryId String

  course   Course         @relation(fields: [courseId], references: [id], onDelete: Cascade)
  category CourseCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  assignedAt DateTime @default(now())

  @@id([courseId, categoryId])
  @@index([categoryId])
}

model Module {
  id          String   @id @default(cuid())
  title       String
  description String?
  position    Int      @default(0)
  isPublished Boolean  @default(false)
  dayNumber   Int?
  duration    Int?
  
  courseId    String
  course      Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)
  
  lessons     Lesson[]
  sessionSlots SessionSlot[]
  quiz        Quiz?
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([courseId, position])
}

model Lesson {
  id          String   @id @default(cuid())
  title       String
  description String?
  videoUrl    String?  // URL Vimeo ou S3
  content     String?  // Contenu texte / Markdown
  position    Int      @default(0)
  isPublished Boolean  @default(false)
  isFree      Boolean  @default(false) // Pour preview avant achat
  duration    Int      @default(0) // En secondes
  
  moduleId    String
  module      Module   @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  
  progress    LessonProgress[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([moduleId, position])
}

model CourseSession {
  id          String   @id @default(cuid())
  courseId    String
  course      Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)
  
  startDate   DateTime
  endDate     DateTime
  location    String?  // e.g. "Centre Épinay", "Paris 10"
  maxSpots    Int      @default(10)
  bookedSpots Int      @default(0)
  
  isPublished Boolean  @default(true)
  
  bookings    CourseSessionBooking[]
  slots       SessionSlot[]

  mainTeacherId String?
  mainTeacher   User?    @relation("MainTeacher", fields: [mainTeacherId], references: [id])

  meetingUrl  String?  // Global/Default meeting link (Teams/Skype)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([courseId])
  @@index([startDate])
  @@index([mainTeacherId])
}

model SessionSlot {
  id        String   @id @default(cuid())
  sessionId String
  moduleId  String?  // Optional: Link to a specific module
  teacherId String?  // Specific teacher for this slot
  
  start     DateTime
  end       DateTime
  location  String?  // Specific location (override session default)
  meetingUrl String? // Specific link (override session default)
  
  session   CourseSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  module    Module?       @relation(fields: [moduleId], references: [id])
  teacher   User?         @relation(fields: [teacherId], references: [id])
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([sessionId])
  @@index([teacherId])
  @@index([start])
}

model SystemSetting {
  key   String @id
  value String
  
  updatedAt DateTime @updatedAt
}

model CourseSessionBooking {
  id              String        @id @default(cuid())
  courseSessionId String
  userId          String
  status          String        @default("BOOKED") // BOOKED, CANCELLED, ATTENDED, ON_HOLD
  justification   String?       // Reason for ON_HOLD status (e.g., missing docs, payment pending)
  
  courseSession   CourseSession @relation(fields: [courseSessionId], references: [id], onDelete: Cascade)
  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  @@unique([courseSessionId, userId]) // Prevent double booking
  @@index([courseSessionId])
  @@index([userId])
}

model PaymentLink {
  id              String   @id @default(cuid())
  userId          String
  courseId        String?
  stripeSessionId String   @unique // Stripe Checkout Session ID
  stripeUrl       String   // The payment URL
  amount          Float    // Amount in EUR
  status          String   @default("PENDING") // PENDING, PAID, EXPIRED, CANCELLED
  expiresAt       DateTime? // Optional expiration
  justification   String?   // Reason for price override
  
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  course          Course?  @relation(fields: [courseId], references: [id], onDelete: Cascade)
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@index([userId])
  @@index([status])
}

model LessonProgress {
  id             String   @id @default(cuid())
  isCompleted    Boolean  @default(false)
  timeSpent      Int      @default(0) // In seconds
  lastAccessedAt DateTime @default(now())
  
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  lessonId    String
  lesson      Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([userId, lessonId])
}

model Enrollment {
  id        String            @id @default(cuid())
  userId    String
  courseId  String
  status    String            @default("ACTIVE")
  progress  Int               @default(0) // pourcentage 0–100 calculé
  
  user      User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  course    Course            @relation(fields: [courseId], references: [id], onDelete: Cascade)
  
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt

  @@unique([userId, courseId])
  @@index([courseId])
}

model Order {
  id              String        @id @default(cuid())
  userId          String
  user            User          @relation(fields: [userId], references: [id])
  
  courseId        String?       // Achat direct d'un cours (simplifié)
  course          Course?       @relation(fields: [courseId], references: [id])
  
  amount          Float
  currency        String        @default("EUR")
  status          String        @default("PENDING")
  stripeSessionId String?       @unique
  stripePaymentId String?
  
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  items           OrderItem[]

  payments        Payment[]
  couponId        String?
  coupon          Coupon?       @relation(fields: [couponId], references: [id])

  @@index([userId])
  @@index([courseId])
  @@index([status])
  @@index([createdAt])
  @@index([couponId])
}

// Détail des lignes de commande (panier multi‑cours)
model OrderItem {
  id        String   @id @default(cuid())
  orderId   String
  courseId  String
  quantity  Int      @default(1)
  unitPrice Float

  order   Order  @relation(fields: [orderId], references: [id], onDelete: Cascade)
  course  Course @relation(fields: [courseId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([orderId])
  @@index([courseId])
}

// --- Modèles Legacy / Présentiel (Location & Planning) ---

model Vehicle {
  id          String         @id @default(cuid())
  model       String
  brand       String
  type        String
  pricePerDay Float
  status      String        @default("AVAILABLE")
  image       String?
  features    String?        // JSON string or comma separated
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  bookings    Booking[]

  @@index([status])
}

model Booking {
  id          String        @id @default(cuid())
  userId      String
  courseId    String?
  vehicleId   String?
  startDate   DateTime
  endDate     DateTime?
  status      String        @default("PENDING")
  totalAmount Float
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  user    User     @relation(fields: [userId], references: [id])
  course  Course?  @relation(fields: [courseId], references: [id])
  vehicle Vehicle? @relation(fields: [vehicleId], references: [id])

  @@index([userId])
  @@index([courseId])
  @@index([vehicleId])
  @@index([status])
  @@index([startDate])
}

model Session {
  id        String       @id @default(cuid())
  courseId  String
  teacherId String?
  startsAt  DateTime
  endsAt    DateTime
  mode      String       @default("IN_PERSON")
  location  String?
  maxSeats  Int?
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt

  course   Course          @relation(fields: [courseId], references: [id])
  teacher  User?           @relation("TeacherSessions", fields: [teacherId], references: [id])
  bookings SessionBooking[]

  @@index([courseId])
  @@index([teacherId])
  @@index([startsAt])
}

model SessionBooking {
  id        String                @id @default(cuid())
  sessionId String
  userId    String
  status    String                @default("BOOKED")
  createdAt DateTime              @default(now())
  updatedAt DateTime              @updatedAt

  session Session @relation(fields: [sessionId], references: [id])
  user    User    @relation(fields: [userId], references: [id])

  @@index([sessionId])
  @@index([userId])
}

// --- Contact & Support ---

model ContactMessage {
  id        String   @id @default(cuid())
  name      String
  email     String
  phone     String?
  subject   String?
  message   String
  createdAt DateTime @default(now())

  @@index([email])
  @@index([createdAt])
}

// --- Documents utilisateurs ---

model UserDocument {
  id          String   @id @default(cuid())
  userId      String
  type        String   // ID_CARD, DRIVING_LICENSE, JUSTIF_DOMICILE, etc.
  fileUrl     String   // URL vers le stockage (S3, etc.)
  status      String   @default("PENDING") // PENDING, APPROVED, REJECTED
  rejectionReason String? // Motif du refus si REJECTED
  uploadedAt  DateTime @default(now())
  reviewedAt  DateTime?

  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([type])
  @@index([status])
}

// --- Adresses utilisateurs ---

model Address {
  id          String   @id @default(cuid())
  userId      String?
  label       String?  // Maison, Travail, etc.
  line1       String
  line2       String?
  postalCode  String
  city        String
  country     String
  isDefault   Boolean  @default(false)

  user        User?    @relation(fields: [userId], references: [id])

  @@index([userId])
}

// --- Paiements ---

model Payment {
  id                String   @id @default(cuid())
  orderId           String
  provider          String   // stripe, paypal, etc.
  providerPaymentId String
  status            String   @default("PENDING") // PENDING, SUCCEEDED, FAILED, REFUNDED
  amount            Float
  currency          String   @default("EUR")
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  order             Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([orderId])
  @@index([status])
}

// --- Coupons / Codes promo ---

model Coupon {
  id          String   @id @default(cuid())
  code        String   @unique
  description String?
  discountPct Int?     // 20 => -20%
  discountAmt Float?   // montant fixe
  validFrom   DateTime?
  validUntil  DateTime?
  maxUses     Int?
  usedCount   Int      @default(0)
  isActive    Boolean  @default(true)

  orders      Order[]

  @@index([code])
  @@index([isActive])
}

model ConsentLog {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  consentType String
  isGranted   Boolean
  ipAddress   String?
  userAgent   String?
  createdAt   DateTime @default(now())

  @@index([userId])
}

model DataExportRequest {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  status    String   @default("PENDING") // PENDING, PROCESSING, COMPLETED, FAILED
  exportUrl String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
}

model Quiz {
  id           String     @id @default(cuid())
  title        String
  description  String?
  passingScore Int        @default(80)
  isPublished  Boolean    @default(true)
  
  courseId     String?
  course       Course?    @relation(fields: [courseId], references: [id])
  
  moduleId     String?    @unique
  module       Module?    @relation(fields: [moduleId], references: [id])
  
  questions    Question[]
  quizAttempts QuizAttempt[]
  
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt

  @@index([courseId])
}

model QuizAttempt {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  quizId      String
  quiz        Quiz     @relation(fields: [quizId], references: [id], onDelete: Cascade)
  score       Int      @default(0)
  isPassed    Boolean  @default(false)
  answers     Json     @default("{}")
  startedAt   DateTime @default(now())
  completedAt DateTime @default(now())

  @@index([userId])
  @@index([quizId])
}

model Question {
  id        String   @id @default(cuid())
  text      String
  type      String   @default("SINGLE") // SINGLE, MULTIPLE
  position  Int      @default(0)
  
  quizId    String
  quiz      Quiz     @relation(fields: [quizId], references: [id], onDelete: Cascade)
  
  options   Option[]
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([quizId])
}

model Option {
  id         String   @id @default(cuid())
  text       String
  isCorrect  Boolean  @default(false)
  
  questionId String
  question   Question @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId])
}

// --- Enums ---

// enum Role {
//   STUDENT
//   INSTRUCTOR
//   ADMIN
// }

// enum CourseType {
//   PERMIS_MOTO
//   PERMIS_AUTO
//   PERMIS_POIDS_LOURD
//   VTC
//   TAXI
//   SSIAP
//   INFORMATIQUE // Réintégré si besoin pour dev web
//   AUTRE
// }

// enum EnrollmentStatus {
//   PENDING
//   ACTIVE
//   COMPLETED
//   CANCELLED
// }

// enum OrderStatus {
//   PENDING
//   PAID
//   FAILED
//   REFUNDED
// }

// enum VehicleType {
//   SEDAN
//   SUV
//   ELECTRIC
//   HYBRID
//   DIESEL
// }

// enum VehicleStatus {
//   AVAILABLE
//   RENTED
//   MAINTENANCE
// }

// enum BookingStatus {
//   PENDING
//   CONFIRMED
//   CANCELLED
//   COMPLETED
// }

// enum SessionMode {
//   IN_PERSON
//   ONLINE
//   HYBRID
// }

// enum SessionBookingStatus {
//   BOOKED
//   CANCELLED
//   ATTENDED
//   NO_SHOW
// }

// ============================================
// SYSTÈME DE RÉSERVATION COURS DE CONDUITE
// ============================================

// Profil instructeur (extension du User avec role INSTRUCTOR)
model InstructorProfile {
  id          String   @id @default(cuid())
  userId      String   @unique
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // Spécialité
  specialty   String   @default("DRIVING") // DRIVING | PROFESSIONAL
  
  // Localisation (pour attribution géographique)
  city        String   // Ex: "Pontault-Combault"
  department  String   // Ex: "77" (Seine-et-Marne)
  postalCode  String?
  
  // Types de permis enseignés (pour instructeurs conduite)
  licenseTypes String[] @default([]) // ["B", "A2", "AAC", etc.]
  
  // Véhicule(s) utilisé(s)
  vehicleType  String?  // "MANUAL" | "AUTOMATIC" | "BOTH"
  
  // Préférences / Disponibilité générale
  maxStudentsPerWeek Int? @default(20)
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  availabilities    InstructorAvailability[]
  assignments       InstructorAssignment[]
  drivingLessons    DrivingLesson[]
  currentInstructorRequests ChangeRequest[] @relation("CurrentInstructor")
  requestedInstructorRequests ChangeRequest[] @relation("RequestedInstructor")
}

// Créneaux de disponibilité (avec support récurrence)
model InstructorAvailability {
  id            String   @id @default(cuid())
  instructorId  String
  instructor    InstructorProfile @relation(fields: [instructorId], references: [id], onDelete: Cascade)
  
  // Créneau ponctuel
  date          DateTime?
  startTime     String   // Format "HH:mm" (ex: "14:00")
  endTime       String   // Format "HH:mm" (ex: "18:00")
  
  // Récurrence (optionnel)
  isRecurring   Boolean  @default(false)
  recurrencePattern String? // "WEEKLY" | "DAILY" | "MONTHLY"
  recurrenceDays    Int[]   @default([]) // [1,3,5] = Lundi, Mercredi, Vendredi (1=Lundi, 7=Dimanche)
  recurrenceEndDate DateTime? // Date de fin de la récurrence
  
  // Statut
  isBooked      Boolean  @default(false)
  
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  // Relations
  lessons       DrivingLesson[]
  
  @@index([instructorId, date])
  @@index([instructorId, isBooked])
}

// Attribution élève-instructeur
model InstructorAssignment {
  id            String   @id @default(cuid())
  studentId     String
  student       User     @relation("StudentAssignments", fields: [studentId], references: [id], onDelete: Cascade)
  
  instructorId  String
  instructor    InstructorProfile @relation(fields: [instructorId], references: [id], onDelete: Cascade)
  
  // Contexte
  courseType    String   // "PERMIS_B" | "PERMIS_A2" | "AAC" | etc.
  assignedBy    String?  // userId de l'admin qui a fait l'attribution (si manuelle)
  assignmentReason String? // "AUTO" | "MANUAL" | "PREFERENCE_CHANGE" | "GEOGRAPHIC"
  
  // Statut
  isActive      Boolean  @default(true)
  startDate     DateTime @default(now())
  endDate       DateTime?
  
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  @@unique([studentId, instructorId, courseType, isActive])
  @@index([studentId, isActive])
  @@index([instructorId, isActive])
}

// Réservation de cours de conduite
model DrivingLesson {
  id              String   @id @default(cuid())
  
  // Participants
  studentId       String
  student         User     @relation("StudentLessons", fields: [studentId], references: [id], onDelete: Cascade)
  
  instructorId    String
  instructor      InstructorProfile @relation(fields: [instructorId], references: [id], onDelete: Cascade)
  
  availabilityId  String?
  availability    InstructorAvailability? @relation(fields: [availabilityId], references: [id], onDelete: SetNull)
  
  // Détails du cours
  date            DateTime
  startTime       String   // Format "HH:mm"
  endTime         String   // Format "HH:mm"
  duration        Int      // En heures (1 ou 2)
  
  // Localisation
  meetingPoint    String?  // Point de rendez-vous
  city            String
  
  // Statut
  status          String   @default("PENDING") // PENDING | CONFIRMED | CANCELLED | COMPLETED
  
  // Validation bilatérale
  studentConfirmed    Boolean @default(false)
  instructorConfirmed Boolean @default(false)
  confirmedAt         DateTime?
  
  // Annulation
  cancelledAt     DateTime?
  cancelledBy     String?  // userId
  cancellationReason String?
  isUrgentCancellation Boolean @default(false)
  urgencyValidatedBy   String? // userId de l'admin/secretary
  
  // Décompte des heures
  isDeducted      Boolean  @default(false) // true si annulation tardive
  
  // Notes
  instructorNotes String?
  studentNotes    String?
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  @@index([studentId, date])
  @@index([instructorId, date])
  @@index([status])
}

// Demande de changement d'instructeur
model ChangeRequest {
  id              String   @id @default(cuid())
  
  studentId       String
  student         User     @relation("StudentChangeRequests", fields: [studentId], references: [id], onDelete: Cascade)
  
  currentInstructorId String
  currentInstructor   InstructorProfile @relation("CurrentInstructor", fields: [currentInstructorId], references: [id], onDelete: Cascade)
  
  requestedInstructorId String?
  requestedInstructor   InstructorProfile? @relation("RequestedInstructor", fields: [requestedInstructorId], references: [id], onDelete: SetNull)
  
  // Justification
  reason          String   // "PREFERENCE_GENDER" | "SCHEDULE_CONFLICT" | "PEDAGOGICAL" | "OTHER"
  details         String?  // Détails de la demande
  
  // Préférences spécifiques
  preferredGender String?  // "MALE" | "FEMALE" | "NO_PREFERENCE"
  
  // Statut
  status          String   @default("PENDING") // PENDING | APPROVED | REJECTED
  reviewedBy      String?  // userId de l'admin
  reviewedAt      DateTime?
  reviewNotes     String?
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  @@index([studentId, status])
  @@index([status])
}
